# Define specific heat capacity of water in J/(kg·K)
c_water = 4180  # J/(kg·K)

def water_density(temp_celsius):
    """
    Calculate the density of water in kg/L as a function of temperature in Celsius.
    Valid for temperatures between 0°C and 100°C.

    Formula source: Empirical data
    """
    if not (0 <= temp_celsius <= 100):
        raise ValueError("Temperature must be between 0°C and 100°C.")
    
    # Empirical equation for water density in kg/m3
    density = (
        999.83952 + 
        16.945176 * temp_celsius - 
        7.9870401e-3 * temp_celsius**2 - 
        46.170461e-6 * temp_celsius**3 + 
        105.56302e-9 * temp_celsius**4 - 
        280.54253e-12 * temp_celsius**5
    ) / (1 + 16.87985e-3 * temp_celsius)
    
    return density/1000  # Density in kg/L

# Table A.1: Pipe spacing factor aT
pipe_spacing_factors = {
    0.00: 1.23,
    0.05: 1.188,
    0.10: 1.156,
    0.15: 1.134
}
# Table A.2: Overcoverage factor au
# (T,R_lambda_B) -> value
overcoverage_factors = {
    (0.05, 0): 1.069, (0.05, 0.05): 1.056, (0.05, 0.10): 1.043, (0.05, 0.15): 1.037,
    (0.075, 0): 1.066, (0.075, 0.05): 1.053, (0.075, 0.10): 1.041, (0.075, 0.15): 1.035,
    (0.1, 0): 1.063, (0.1, 0.05): 1.050, (0.1, 0.10): 1.039, (0.1, 0.15): 1.0335,
    (0.15, 0): 1.057, (0.15, 0.05): 1.046, (0.15, 0.10): 1.035, (0.15, 0.15): 1.0305,
    (0.2, 0): 1.051, (0.2, 0.05): 1.041, (0.2, 0.10): 1.0315, (0.2, 0.15): 1.0275,
    (0.225, 0): 1.048, (0.225, 0.05): 1.038, (0.225, 0.10): 1.0295, (0.225, 0.15): 1.026,
    (0.3, 0): 1.0395, (0.3, 0.05): 1.031, (0.3, 0.10): 1.024, (0.3, 0.15): 1.021,
    (0.375, 0): 1.030, (0.375, 0.05): 1.0221, (0.375, 0.10): 1.0181, (0.375, 0.15): 1.015,
}

# Table A.3: Pipe diameter factor aD
pipe_diameter_factors = {
    (0.05, 0): 1.013, (0.05, 0.05): 1.013, (0.05, 0.10): 1.012, (0.05, 0.15): 1.011,
    (0.075, 0): 1.021, (0.075, 0.05): 1.019, (0.075, 0.10): 1.016, (0.075, 0.15): 1.014,
    (0.1, 0): 1.029, (0.1, 0.05): 1.025, (0.1, 0.10): 1.022, (0.1, 0.15): 1.018,
    (0.15, 0): 1.04, (0.15, 0.05): 1.034, (0.15, 0.10): 1.029, (0.15, 0.15): 1.024,
    (0.2, 0): 1.046, (0.2, 0.05): 1.04, (0.2, 0.10): 1.035, (0.2, 0.15): 1.03,
    (0.225, 0): 1.049, (0.225, 0.05): 1.043, (0.225, 0.10): 1.038, (0.225, 0.15): 1.033,
    (0.3, 0): 1.053, (0.3, 0.05): 1.049, (0.3, 0.10): 1.044, (0.3, 0.15): 1.039,
    (0.375, 0): 1.056, (0.375, 0.05): 1.051, (0.375, 0.10): 1.046, (0.375, 0.15): 1.042,
}